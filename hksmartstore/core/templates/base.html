{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HK Smart Store</title>

  <link href="https://fonts.googleapis.com/css2?family=Signika:wght@300..700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>

<body>

<!-- ðŸ”¹ NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top">
  <div class="container-fluid px-4">
    
    <!-- ðŸ”¹ Logo -->
    <a class="navbar-brand d-flex align-items-center" href="/">
      <img src="{% static 'images/logo.png' %}" alt="" height="35" class="me-2">
      <span class="fw-bold text-primary">HK Smart Store</span>
    </a>

    <!-- ðŸ”¹ Centered Search Bar -->
    <div class="flex-grow-1 d-flex justify-content-center">
      <form action="{% url 'search' %}" method="get" class="d-flex search-bar" role="search">
        <input 
          class="form-control search-input" 
          type="search" 
          name="q" 
          placeholder="Search for Products, Brands and More" 
          aria-label="Search"
          value="{{ request.GET.q|default:'' }}"
          required
        >
        <button class="btn search-btn" type="submit">
          <i class="fa fa-search"></i>
        </button>
      </form>
    </div>

    <!-- ðŸ”¹ Right Icons -->
    <ul class="navbar-nav ms-auto align-items-center gap-3">

      <!-- Profile Dropdown -->
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle fw-semibold" href="#" id="profileDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
          <i class="bi bi-person-circle me-1"></i>
          {% if request.user.is_authenticated %}
            {{ request.user.username|upper }}
          {% else %}
            Profile
          {% endif %}
        </a>

        <ul class="dropdown-menu dropdown-menu-end shadow-sm" aria-labelledby="profileDropdown">
          {% if request.user.is_authenticated %}
            <li><a class="dropdown-item" href="{% url 'wishlist' %}"><i class="bi bi-heart me-2 text-danger"></i>Wishlist</a></li>
            <li><a class="dropdown-item" href="{% url 'order_list' %}"><i class="bi bi-bag-check me-2 text-primary"></i>My Orders</a></li>
            <li><a class="dropdown-item" href="{% url 'notifications' %}"><i class="bi bi-bell me-2 text-warning"></i>Notifications</a></li>
            <li><a class="dropdown-item" href="{% url 'coupons' %}"><i class="bi bi-ticket-perforated me-2 text-success"></i>Coupons</a></li>
            <li><a class="dropdown-item" href="{% url 'become_vendor' %}"><i class="bi bi-shop me-2 text-primary"></i>Become a Vendor</a></li>

            <!-- ðŸ”¹ Wallet & Referrals Added Here -->
            <li><a class="dropdown-item" href="{% url 'wallet_view' %}"><i class="bi bi-wallet2 me-2 text-success"></i>Wallet</a></li>
            <li><a class="dropdown-item" href="{% url 'referrals_view' %}"><i class="bi bi-people-fill me-2 text-info"></i>Referrals</a></li>

            {% if is_vendor %}
              <li><a class="dropdown-item" href="{% url 'vendor_dashboard' %}"><i class="bi bi-grid me-2 text-success"></i>Vendor Dashboard</a></li>
            {% endif %}

            {% if request.user.is_superuser or request.user.is_staff %}
              <li><a class="dropdown-item" href="{% url 'admin_dashboard' %}"><i class="bi bi-shield-lock me-2 text-danger"></i>Admin Dashboard</a></li>
            {% endif %}

            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item text-danger" href="{% url 'logout' %}"><i class="bi bi-box-arrow-right me-2"></i>Logout</a></li>
          {% else %}
            <li><a class="dropdown-item text-primary" href="{% url 'login' %}"><i class="bi bi-box-arrow-in-right me-2"></i>Login</a></li>
          {% endif %}
        </ul>
      </li>

      <!-- Cart -->
      <li class="nav-item">
        <a class="nav-link fw-semibold" href="{% url 'cart_view' %}">
          <i class="bi bi-cart3 me-1"></i> Cart
          {% if cart_count %}
            <span class="badge bg-danger rounded-pill">{{ cart_count }}</span>
          {% endif %}
        </a>
      </li>

      <!-- Subscribe & Earn -->
      <li class="nav-item">
        <a class="btn btn-outline-success fw-semibold" href="{% url 'subscribe_earn' %}">
          <i class="bi bi-cash-stack me-1"></i> Subscribe & Earn
        </a>
      </li>
    </ul>
  </div>
</nav>

<!-- ðŸ”¹ Page Content -->
{% block content %}
{% endblock %}

<!-- ðŸ”¹ Alerts -->
{% if messages %}
  <div class="container mt-3" style="max-width: 700px;">
    {% for message in messages %}
      <div class="alert alert-{{ message.tags }} alert-dismissible fade show shadow-sm"
           role="alert"
           style="font-family: 'Signika', sans-serif; font-weight: 500;">
        <i class="bi bi-info-circle me-2"></i> {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    {% endfor %}
  </div>
{% endif %}

<!-- ðŸ”¹ Footer -->
{% include 'core/footer.html' %}

<!-- ðŸ”¹ Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="{% static 'js/script.js' %}"></script>

<script>
  // Auto-hide alerts after 4 seconds
  setTimeout(() => {
    document.querySelectorAll('.alert').forEach(alert => {
      alert.classList.remove('show');
      setTimeout(() => alert.remove(), 500);
    });
  }, 4000);
</script>

</body>
</html>
