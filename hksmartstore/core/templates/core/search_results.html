{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container my-5" style="font-family: 'Signika', sans-serif;">

  <h4 class="fw-bold text-primary mb-4">
    <i class="bi bi-search me-2"></i> Search Results for "{{ query }}"
  </h4>

  {% if not products and not categories and not vendors %}
    <div class="text-center mt-5">
      <img src="{% static 'images/empty_search.png' %}" alt="No Results" width="200">
      <h5 class="mt-3 text-muted">No results found for "{{ query }}"</h5>
      <a href="/" class="btn btn-primary mt-3">Back to Home</a>
    </div>
  {% else %}
  
  <!-- ðŸ”¹ Product Results -->
  {% if products %}
  <h5 class="fw-semibold text-dark mb-3">Products</h5>
  <div class="row g-3">
    {% for product in products %}
    <div class="col-md-3 col-sm-6">
      <div class="card shadow-sm border-0 rounded-3 h-100 hover-scale">
        <a href="{% url 'product_detail' product.id %}" class="text-decoration-none text-dark">
          <div class="ratio ratio-1x1">
            {% if product.images.first %}
              <img src="{{ product.images.first.image.url }}" 
                   class="card-img-top rounded-top" 
                   alt="{{ product.name }}" 
                   style="object-fit: cover;">
            {% else %}
              <img src="{% static 'images/default-product.png' %}" 
                   class="card-img-top rounded-top" 
                   alt="No Image">
            {% endif %}
          </div>
          <div class="card-body text-center">
            <h6 class="fw-semibold text-truncate">{{ product.name }}</h6>
            <p class="text-primary fw-bold mb-0">â‚¹{{ product.price }}</p>
          </div>
        </a>
      </div>
    </div>
    {% endfor %}
  </div>
  {% endif %}

  <hr class="my-4">

  <!-- ðŸ”¹ Category Results -->
  {% if categories %}
  <h5 class="fw-semibold text-dark mb-3">Categories</h5>
  <div class="d-flex flex-wrap gap-3">
    {% for category in categories %}
      <a href="{% url 'category_products' category.slug %}" 
         class="btn btn-outline-primary rounded-pill px-4">
        {{ category.name }}
      </a>
    {% endfor %}
  </div>
  {% endif %}

  <hr class="my-4">

  <!-- ðŸ”¹ Vendor Results -->
  {% if vendors %}
  <h5 class="fw-semibold text-dark mb-3">Vendors</h5>
  <div class="row g-3">
    {% for vendor in vendors %}
    <div class="col-md-4 col-sm-6">
      <div class="card shadow-sm border-0 rounded-3 p-3 text-center">
        {% if vendor.profile_picture %}
          <img src="{{ vendor.profile_picture.url }}" 
               class="rounded-circle mb-2" 
               width="80" height="80" 
               style="object-fit: cover;">
        {% else %}
          <img src="{% static 'images/default-vendor.png' %}" 
               class="rounded-circle mb-2" 
               width="80" height="80">
        {% endif %}
        <h6 class="fw-semibold">{{ vendor.business_name }}</h6>
        <p class="text-muted small">{{ vendor.email }}</p>
      </div>
    </div>
    {% endfor %}
  </div>
  {% endif %}

  {% endif %}
</div>
{% include 'core/footer.html' %}
{% endblock %}
