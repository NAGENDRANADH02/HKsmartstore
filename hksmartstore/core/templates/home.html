{% extends 'base.html' %}
{% load static %}

{% block content %}

<!-- ðŸ”¹ Flipkart-Style Category Bar -->
<div class="category-bar py-3 shadow-sm bg-white">
  <div class="container">
    <div class="d-flex flex-wrap justify-content-between align-items-center text-center gap-3">
      {% for category in categories %}
      <div class="category-card flex-fill">
        <a href="{% url 'category_products' category.slug %}" class="text-decoration-none text-dark d-block">
          <div class="category-img-container d-flex justify-content-center align-items-center">
            {% if category.image %}
              <img src="{{ category.image.url }}" alt="{{ category.name }}" class="category-img">
            {% else %}
              <img src="{% static 'images/default-category.png' %}" alt="{{ category.name }}" class="category-img">
            {% endif %}
          </div>
          <p class="mt-2 mb-0 fw-semibold category-name">{{ category.name }}</p>
        </a>
      </div>
      {% endfor %}
    </div>
  </div>
</div>

<!-- ðŸ§­ Hero Banner Carousel -->
<div id="heroCarousel" class="carousel slide mt-3 mb-4" data-bs-ride="carousel">
  <div class="carousel-indicators">
    <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="0" class="active"></button>
    <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="1"></button>
    <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="2"></button>
  </div>

  <div class="carousel-inner rounded-4 shadow-sm">
    <div class="carousel-item active">
      <img src="{% static 'images/22.jpg' %}" class="d-block w-100 hero-img" alt="Sale Banner 1">
      <div class="carousel-caption d-none d-md-block text-start">
         
      </div>
    </div>

    <div class="carousel-item">
      <img src="{% static 'images/111.jpg' %}" class="d-block w-100 hero-img" alt="Sale Banner 2">
      <div class="carousel-caption d-none d-md-block text-end">
         
      </div>
    </div>

    <div class="carousel-item">
      <img src="{% static 'images/333.jpg' %}" class="d-block w-100 hero-img" alt="Sale Banner 3">
      <div class="carousel-caption d-none d-md-block text-center">
        
      </div>
    </div>
  </div>

  <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
  </button>
</div>

<!-- ðŸ”¹ Dynamic Category Rows with Scroll -->
{% for item in category_products %}
<section class="category-section my-5">
  <div class="row align-items-center">
    <!-- ðŸŸ¦ Left Category Panel -->
    <div class="col-md-3 col-sm-12 category-left text-white p-4 rounded-3"
         style="background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('{{ item.category.image.url }}') center/cover no-repeat;">
      <div class="bg-overlay p-3 rounded-3">
        <h4 class="fw-bold text-light mb-3">{{ item.category.name }}</h4>
        <a href="{% url 'category_products' item.category.slug %}" class="btn btn-light btn-sm fw-semibold rounded-pill px-3">
          View All
        </a>
      </div>
    </div>
      <!-- ðŸŸ¦ Right Scrollable Products -->
      <div class="col-md-9 col-sm-12">
          <div class="scroll-container d-flex align-items-center gap-3 p-2">
            {% for product in item.products %}
            {% if product.slug %}
                <a href="{% url 'product_detail' product.slug %}" class="text-decoration-none text-dark">
            {% else %}
                <a href="#" class="text-decoration-none text-dark disabled">
            {% endif %}

          <div class="scroll-card card border-0 shadow-sm rounded-4">
              {% if product.images.all %}
              {% with first_image=product.images.first %}
                {% if first_image %}
                  <img src="{{ first_image.image.url }}" class="card-img-top rounded-top-4" alt="{{ product.name }}">
                {% else %}
                  <img src="{% static 'images/default-product.png' %}" class="card-img-top rounded-top-4" alt="{{ product.name }}">
                {% endif %}
              {% endwith %}
              {% else %}
          <img src="{% static 'images/default-product.png' %}" class="card-img-top rounded-top-4" alt="{{ product.name }}">
            {% endif %}

        <div class="card-body text-center py-2">
          <h6 class="card-title text-truncate mb-1">{{ product.name }}</h6>
          <p class="fw-semibold text-primary mb-0">â‚¹{{ product.price }}</p>
        </div>
      </div>
    </a>
    {% endfor %}
  </div>
</div>

  </div>
</section>
{% endfor %}
{% endblock %}
